{% extends "base.html" %}

{% block title %}
Reset Password
{% endblock %}
{% block content %}
<h1>Reset Password</h1>
<form method="POST">
    {{ form.hidden_tag() }}
    <div class="mb-3">
        {{ form.password.label(class="form-label") }}
        {{ form.password(class="form-control", id="password") }}
        {% if form.password.description %}
        <div class="form-text">{{ form.password.description }}</div>
        {% endif %}
        {% for error in form.password.errors %}
        <div class="text-danger">{{ error }}</div>
        {% endfor %}
    </div>
    <div class="mb-3">
        {{ form.confirm_password.label(class="form-label") }}
        {{ form.confirm_password(class="form-control", id="confirm_password", oninput="checkPasswordMatch()") }}
        <div id="password-match-error" class="text-danger"></div>
        {% for error in form.confirm_password.errors %}
        <div class="text-danger">{{ error }}</div>
        {% endfor %}
    </div>
    {{ form.submit(class="btn btn-primary") }}
</form>
{% endblock %}

<script>
    document.querySelector('form').addEventListener('submit', function (e) {
        const password = document.getElementById("password").value;
        const confirmPassword = document.getElementById("confirm_password").value;

        if (password !== confirmPassword) {
            e.preventDefault();
        }
    });

    function checkPasswordMatch() {
        const confirmInput = document.getElementById("confirm_password");
        const errorElement = document.getElementById("password-match-error");

        if (document.getElementById("password").value !== confirmInput.value) {
            confirmInput.classList.add("is-invalid");
            errorElement.textContent = "Passwords do not match";
        } else {
            confirmInput.classList.remove("is-invalid");
            errorElement.textContent = "";
        }
    }
</script>